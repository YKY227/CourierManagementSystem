(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[463],{57:function(e,t,s){Promise.resolve().then(s.bind(s,2702))},6463:function(e,t,s){"use strict";var a=s(1169);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},2702:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return n}});var a=s(7437),l=s(2265),r=s(6463),o=s(239);function n(e){let{params:t}=e,s=(0,r.useRouter)(),{id:n}=t,{jobs:i,pendingActions:c,loaded:d,markJobStatus:p,markStopCompleted:u}=(0,o.D)(),x=(0,l.useMemo)(()=>i.find(e=>e.id===n),[i,n]);if(!d)return(0,a.jsx)("div",{className:"flex min-h-[60vh] items-center justify-center text-xs text-slate-400",children:"Loading job…"});if(!x)return(0,a.jsxs)("div",{className:"min-h-screen bg-slate-950 px-4 py-8 text-slate-50",children:[(0,a.jsx)("button",{type:"button",onClick:()=>s.push("/driver/jobs"),className:"mb-4 text-xs text-slate-400 hover:text-slate-200",children:"← Back to jobs"}),(0,a.jsx)("p",{className:"text-sm font-semibold",children:"Job not found"}),(0,a.jsx)("p",{className:"mt-1 text-xs text-slate-400",children:"This job ID is not in the current offline dataset."})]});let m=c.some(e=>e.jobId===x.id);return(0,a.jsxs)("div",{className:"min-h-screen bg-slate-950",children:[(0,a.jsx)("header",{className:"sticky top-0 z-20 border-b border-slate-800 bg-slate-950/95 px-4 py-3 backdrop-blur",children:(0,a.jsxs)("div",{className:"mx-auto flex max-w-md items-center justify-between gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>s.push("/driver/jobs"),className:"text-xs text-slate-400 hover:text-slate-100",children:"← Jobs"}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"text-[11px] font-mono text-slate-400",children:x.displayId}),(0,a.jsx)("p",{className:"text-xs font-semibold text-slate-50",children:function(e){switch(e){case"booked":return"Booked";case"allocated":return"Allocated";case"pickup":return"Out for pickup";case"in-progress":return"In progress";case"completed":return"Completed";default:return e}}(x.status)}),m&&(0,a.jsx)("p",{className:"text-[10px] text-amber-300",children:"Pending sync…"})]})]})}),(0,a.jsxs)("main",{className:"mx-auto max-w-md px-4 py-4 space-y-4",children:[(0,a.jsxs)("section",{className:"rounded-xl border border-slate-800 bg-slate-900/70 p-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-[11px] uppercase tracking-wide text-slate-400",children:"Pickup"}),(0,a.jsx)("p",{className:"text-sm font-semibold text-slate-50",children:x.originLabel}),(0,a.jsx)("p",{className:"text-[11px] text-slate-400",children:x.areaLabel})]}),(0,a.jsxs)("div",{className:"text-right text-[11px] text-slate-300",children:[(0,a.jsx)("p",{children:x.pickupDate}),(0,a.jsx)("p",{className:"font-medium",children:x.pickupWindow}),(0,a.jsxs)("p",{className:"mt-1 text-slate-400",children:[x.totalStops," stops \xb7 ",x.totalBillableWeightKg.toFixed(1)," kg"]})]})]}),(0,a.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>p(x.id,"pickup"),className:"flex-1 rounded-lg bg-sky-600 px-3 py-2 text-xs font-medium text-white hover:bg-sky-700",children:"Mark out for pickup"}),(0,a.jsx)("button",{type:"button",className:"flex-1 rounded-lg border border-slate-600 px-3 py-2 text-xs font-medium text-slate-100 hover:border-sky-500 hover:text-sky-100",children:"Open in Maps"})]}),m&&(0,a.jsx)("p",{className:"mt-2 text-[10px] text-amber-300",children:"Changes stored locally – will sync when online & connected to server."})]}),(0,a.jsxs)("section",{className:"rounded-xl border border-slate-800 bg-slate-900/70 p-4",children:[(0,a.jsx)("h2",{className:"mb-3 text-xs font-semibold uppercase tracking-wide text-slate-400",children:"Route & Stops"}),(0,a.jsx)("ol",{className:"relative border-l border-slate-700 pl-4",children:x.stops.slice().sort((e,t)=>e.sequence-t.sequence).map(e=>{let t=c.some(t=>t.jobId===x.id&&t.stopId===e.id);return(0,a.jsxs)("li",{className:"mb-5 last:mb-0",children:[(0,a.jsx)("div",{className:"absolute -left-[7px] mt-1.5 h-3.5 w-3.5 rounded-full border border-slate-500 bg-slate-900"}),(0,a.jsxs)("div",{className:"ml-2 text-[11px] text-slate-200",children:[(0,a.jsxs)("p",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:[function(e){switch(e){case"pickup":return"Pickup";case"delivery":return"Delivery";case"return":return"Return"}}(e.type)," \xb7 Stop ",e.sequence]}),(0,a.jsx)("p",{className:"font-semibold text-slate-50",children:e.label}),(0,a.jsxs)("p",{className:"text-slate-400",children:[e.addressLine1," \xb7 S(",e.postalCode,")"]}),(0,a.jsxs)("p",{className:"mt-0.5 text-slate-400",children:["Contact: ",e.contactName," \xb7 ",e.contactPhone]}),e.remarks&&(0,a.jsxs)("p",{className:"mt-0.5 text-slate-500",children:["Remarks: ",e.remarks]}),(0,a.jsxs)("div",{className:"mt-1 flex flex-wrap items-center gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>u(x.id,e.id),className:["rounded-md border px-2 py-1 text-[10px]",e.completed?"border-emerald-400 text-emerald-300":"border-slate-600 text-slate-100 hover:border-sky-500"].join(" "),children:e.completed?"Completed":"Mark completed"}),(0,a.jsx)("button",{type:"button",className:"rounded-md border border-slate-600 px-2 py-1 text-[10px] text-slate-100 hover:border-sky-500",children:"Call / WhatsApp"}),t&&(0,a.jsx)("span",{className:"text-[10px] text-amber-300",children:"Pending sync…"})]})]})]},e.id)})}),(0,a.jsx)("p",{className:"mt-4 text-[11px] text-slate-500",children:"All changes are stored locally so you can continue even if network is unstable. When we connect this to the backend, these updates will sync to the operations system and customer tracking."})]})]})]})}},239:function(e,t,s){"use strict";s.d(t,{D:function(){return n}});var a=s(2265);let l=[{id:"job-1",displayId:"STL-251123-1023",serviceType:"same-day",status:"pickup",pickupWindow:"09:00 – 12:00",pickupDate:"2025-11-25",totalStops:3,totalBillableWeightKg:18.4,originLabel:"Tech Hygiene Hub",areaLabel:"Central / CBD",stops:[{id:"s1",type:"pickup",sequence:1,label:"Pickup – Tech Hygiene Hub",addressLine1:"10 Dover Drive",postalCode:"138683",contactName:"Yong",contactPhone:"+65 9000 0001",remarks:"Laptop cleaning equipment – handle carefully."},{id:"s2",type:"delivery",sequence:2,label:"Delivery – ITE College Central",addressLine1:"2 Ang Mo Kio Drive",postalCode:"567720",contactName:"Operations Counter",contactPhone:"+65 9000 0002",remarks:"Deliver before 4pm; report to security."},{id:"s3",type:"delivery",sequence:3,label:"Delivery – Client Office",addressLine1:"1 Fusionopolis Way",postalCode:"138632",contactName:"IT Dept",contactPhone:"+65 9000 0003",remarks:"Restricted access – call on arrival."}]},{id:"job-2",displayId:"STL-261123-2045",serviceType:"express-3h",status:"allocated",pickupWindow:"14:00 – 17:00",pickupDate:"2025-11-25",totalStops:2,totalBillableWeightKg:5.2,originLabel:"Cleanroom Logistics",areaLabel:"West / Jurong",stops:[{id:"s1",type:"pickup",sequence:1,label:"Pickup – Cleanroom Logistics",addressLine1:"50 Jurong Gateway Road",postalCode:"608549",contactName:"Supervisor",contactPhone:"+65 9000 1000"},{id:"s2",type:"delivery",sequence:2,label:"Delivery – Lab Partner",addressLine1:"5 Science Park Drive",postalCode:"118260",contactName:"Lab Admin",contactPhone:"+65 9000 2000"}]}],r="driver-jobs-state-v1";function o(){return"PA-".concat(Date.now(),"-").concat(Math.floor(1e4*Math.random()))}function n(){let[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)([]),[i,c]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{try{let e=window.localStorage.getItem(r);if(e){let s=JSON.parse(e);t(s.jobs||[]),n(s.pendingActions||[])}else t(l),n([])}catch(e){console.error("Failed to load driver jobs from localStorage",e),t(l),n([])}finally{c(!0)}},[]),(0,a.useEffect)(()=>{if(i)try{let t=JSON.stringify({jobs:e,pendingActions:s});window.localStorage.setItem(r,t)}catch(e){console.error("Failed to save driver jobs to localStorage",e)}},[e,s,i]),{jobs:e,pendingActions:s,loaded:i,markJobStatus:(0,a.useCallback)((e,s)=>{t(t=>t.map(t=>t.id===e?{...t,status:s}:t));let a={id:o(),type:"job-status",jobId:e,newStatus:s,createdAt:new Date().toISOString()};n(e=>[...e,a])},[]),markStopCompleted:(0,a.useCallback)((e,s)=>{t(t=>t.map(t=>t.id===e?{...t,stops:t.stops.map(e=>e.id===s?{...e,completed:!0}:e)}:t));let a={id:o(),type:"stop-completed",jobId:e,stopId:s,createdAt:new Date().toISOString()};n(e=>[...e,a])},[]),clearPendingAction:(0,a.useCallback)(e=>{n(t=>t.filter(t=>t.id!==e))},[])}}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=57)}),_N_E=e.O()}]);